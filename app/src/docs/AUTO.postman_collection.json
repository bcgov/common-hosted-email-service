{
	"info": {
		"_postman_id": "a4e8e8c5-4667-4bc8-a0e5-0ec2c4fc0bb7",
		"name": "AUTO",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Common Hosted Email Service",
			"item": [
				{
					"name": "v1",
					"item": [
						{
							"name": "Health",
							"item": [
								{
									"name": "Request a Token",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "33a832ed-3f5a-4165-93db-62ecf4440208",
												"exec": [
													"var jsonData = JSON.parse(responseBody);\r",
													"var jwt = jsonData.access_token;\r",
													"\r",
													"pm.environment.set(\"token\", jwt);\r",
													"\r",
													"console.log('environemnt variable set:', jwt);"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "username",
													"value": "{{CMNSRV_CLIENTID}}",
													"type": "string"
												},
												{
													"key": "password",
													"value": "{{CMNSRV_CLIENTSECRET}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"name": "Content-Type",
												"type": "text",
												"value": "application/x-www-form-urlencoded"
											}
										],
										"body": {
											"mode": "urlencoded",
											"urlencoded": [
												{
													"key": "grant_type",
													"value": "client_credentials",
													"type": "text"
												}
											]
										},
										"url": {
											"raw": "{{auth_token_endpoint}}",
											"host": [
												"{{auth_token_endpoint}}"
											]
										},
										"description": "This request will get an OAuth Access Token that is required for calls to the Common Services API's.\n\nThe reponse from this request (the Access Token) can be attached to the top level 'Common Services' collection and then 'Inherited from parent' by the requests contained inside it."
									},
									"response": []
								},
								{
									"name": "/health",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{host}}/api/v1/health",
											"host": [
												"{{host}}"
											],
											"path": [
												"api",
												"v1",
												"health"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "b0f908f4-5056-431e-a830-012e0546a444",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "27f8e38f-c0a8-4541-84a1-27c99af5da28",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"description": "This folder contains the API calls available for the Common Hosted Email Service (CHES).\nFor more documentation about this Common Service see: https://github.com/bcgov/common-hosted-email-service/blob/master/README.md",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "608cd91f-a36f-4d5a-9094-4602822f46ae",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "c29f528b-f2f6-407a-8d70-fe01ff9c69c4",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "c0c710fe-3d40-47a5-a924-e9058091bda9",
				"type": "text/javascript",
				"exec": [
					"// if token exists",
					"if (pm.variables.get(\"token\")){",
					"    // log token",
					"    console.log('has token', pm.variables.get(\"token\"));    ",
					"}",
					"else{",
					"    console.log('no token yet');",
					"    // TODO: run 'Request a Token' request in this collection",
					"    // requests in the collection are run in the order they appear in the Postman GUI.",
					"    // It might be better to just manually run the 'Request a Token' request initially ",
					"    // see: https://learning.postman.com/docs/running-collections/building-workflows/",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "743aad65-ee08-4bc4-8052-f08f2615a009",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}